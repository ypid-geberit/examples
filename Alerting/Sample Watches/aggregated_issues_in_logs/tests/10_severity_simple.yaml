---

# yamllint disable rule:line-length rule:comments-indentation

watch_name: aggregated_issues_in_logs
mapping_file: ./aggregated_issues_in_logs/mapping.json
index: log_network-switch__v1_1984-05-23
type: doc
match: true
watch_file: ./aggregated_issues_in_logs/watch.yaml
scripts:
  - name: 'aggregated_issues_in_logs-index_transform'
    path: './aggregated_issues_in_logs/scripts/aggregated_issues_in_logs-index_transform.yaml'
  - name: 'aggregated_issues_in_logs-deterministic_log'
    path: './aggregated_issues_in_logs/scripts/aggregated_issues_in_logs-deterministic_log.yaml'

events:

  - id: 1
    offset: -5400
    msg: Harmless message
    severity: 2
    '#source': test
    host: sw01.example.org
    category: chassis
    # user: 'test string'

  - id: 2
    offset: -5400
    msg: Ports Unrecoverable fault on PoE controller 2.
    severity: 5
    '#source': test2
    host: sw01.example.org
    category: chassis
    user:
      id: 23
      name: 'fnord'

expected_response: "Watch payload to be indexed by Elasticsearch: {_shards={total=5, failed=0, successful=5, skipped=0}, hits={hits=[], total=2, max_score=0.0}, took=11, timed_out=false}"
